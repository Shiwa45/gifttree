{% extends 'base.html' %}
{% load static %}

{% block title %}{{ post.meta_title }} - GiftTree Blog{% endblock %}
{% block meta_description %}{{ post.meta_description }}{% endblock %}

{% block content %}
<div style="max-width: 900px; margin: 0 auto; padding: 40px 20px;">
    <!-- Breadcrumb -->
    <div style="margin-bottom: 20px; font-size: 14px; color: #666;">
        <a href="{% url 'core:home' %}" style="color: #666; text-decoration: none;">Home</a> /
        <a href="{% url 'blog:blog_list' %}" style="color: #666; text-decoration: none;">Blog</a> /
        {% if post.category %}
        <a href="{% url 'blog:category' post.category.slug %}" style="color: #666; text-decoration: none;">{{ post.category.name }}</a> /
        {% endif %}
        <span>{{ post.title|truncatewords:5 }}</span>
    </div>

    <!-- Featured Image -->
    {% if post.featured_image %}
    <img src="{{ post.featured_image.url }}" alt="{{ post.title }}" style="width: 100%; height: 400px; object-fit: cover; border-radius: 12px; margin-bottom: 30px;">
    {% endif %}

    <!-- Post Header -->
    <div style="margin-bottom: 30px;">
        {% if post.category %}
        <a href="{% url 'blog:category' post.category.slug %}" style="display: inline-block; padding: 6px 16px; background: #E3F2FD; color: #1976D2; border-radius: 4px; font-size: 14px; margin-bottom: 15px; text-decoration: none;">
            {{ post.category.name }}
        </a>
        {% endif %}

        <h1 style="font-size: 36px; font-weight: 700; color: #333; margin-bottom: 20px; line-height: 1.3;">{{ post.title }}</h1>

        <div style="display: flex; align-items: center; gap: 20px; font-size: 14px; color: #666; padding-bottom: 20px; border-bottom: 2px solid #f0f0f0;">
            <span><i class="far fa-user"></i> {{ post.author.get_full_name|default:post.author.username }}</span>
            <span><i class="far fa-calendar"></i> {{ post.published_at|date:"F d, Y" }}</span>
            <span><i class="far fa-clock"></i> {{ post.reading_time }} min read</span>
            <span><i class="far fa-eye"></i> {{ post.views_count }} views</span>
        </div>
    </div>

    <!-- Post Content -->
    <div style="font-size: 16px; line-height: 1.8; color: #333; margin-bottom: 40px;">
        {{ post.content|safe }}
    </div>

    <!-- Tags -->
    {% if post.tags.exists %}
    <div style="margin-bottom: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
        <strong style="font-size: 14px; color: #666;">Tags:</strong>
        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px;">
            {% for tag in post.tags.all %}
            <a href="{% url 'blog:tag' tag.slug %}" style="padding: 6px 12px; background: white; color: #666; border-radius: 20px; text-decoration: none; font-size: 13px; border: 1px solid #ddd;">
                {{ tag.name }}
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Related Products -->
    {% if post.related_products.exists %}
    <div style="margin-bottom: 40px;">
        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 20px;">Related Products</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;">
            {% for product in post.related_products.all|slice:":4" %}
            <a href="{% url 'products:product_detail' product.slug %}" style="text-decoration: none; color: inherit;">
                <div style="background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    {% if product.primary_image %}
                    <img src="{{ product.primary_image.image.url }}" alt="{{ product.name }}" style="width: 100%; height: 150px; object-fit: cover;">
                    {% endif %}
                    <div style="padding: 15px;">
                        <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 8px;">{{ product.name|truncatewords:5 }}</h4>
                        <p style="font-size: 16px; font-weight: 700; color: var(--primary-color);">â‚¹{{ product.current_price }}</p>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Related Posts -->
    {% if related_posts %}
    <div style="margin-top: 60px; padding-top: 40px; border-top: 2px solid #f0f0f0;">
        <h3 style="font-size: 24px; font-weight: 700; margin-bottom: 30px;">Related Posts</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
            {% for related_post in related_posts %}
            <a href="{% url 'blog:post_detail' related_post.slug %}" style="text-decoration: none; color: inherit;">
                <div style="background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    {% if related_post.featured_image %}
                    <img src="{{ related_post.featured_image.url }}" alt="{{ related_post.title }}" style="width: 100%; height: 150px; object-fit: cover;">
                    {% else %}
                    <div style="width: 100%; height: 150px; background: var(--pink-gradient); display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-gift" style="font-size: 36px; color: white;"></i>
                    </div>
                    {% endif %}
                    <div style="padding: 15px;">
                        <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">{{ related_post.title }}</h4>
                        <p style="font-size: 12px; color: #999;">{{ related_post.published_at|date:"M d, Y" }}</p>
                    </div>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
