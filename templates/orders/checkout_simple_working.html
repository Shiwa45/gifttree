{% extends 'base.html' %}
{% load static %}

{% block title %}Checkout - Complete Your Order | GiftTree{% endblock %}

{% block content %}
<div style="padding: 20px; max-width: 1200px; margin: 0 auto;">
    <h1>Checkout</h1>
    
    <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
        <h2>Your Items ({{ cart_items|length }})</h2>
        
        {% for item in cart_items %}
            <div style="display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #eee;">
                <img src="{% if item.product.primary_image %}{{ item.product.primary_image.get_image_url }}{% else %}{% static 'images/products/default.jpg' %}{% endif %}" 
                     alt="{{ item.product.name }}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 4px; margin-right: 15px;">
                <div style="flex: 1;">
                    <h4 style="margin: 0 0 5px 0;">{{ item.product.name }}</h4>
                    <p style="margin: 0; color: #666;">Quantity: {{ item.quantity }}</p>
                </div>
                <div style="font-weight: bold; color: #E91E63;">₹{{ item.total_price }}</div>
            </div>
        {% empty %}
            <p>No items in cart</p>
        {% endfor %}
    </div>
    
    <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
        <h2>Order Summary</h2>
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
            <span>Subtotal:</span>
            <span>₹{{ subtotal }}</span>
        </div>
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
            <span>Delivery:</span>
            <span>₹{{ delivery_charge }}</span>
        </div>
        <hr>
        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 18px;">
            <span>Total:</span>
            <span style="color: #E91E63;">₹{{ total }}</span>
        </div>
    </div>
    
    {% if user.is_authenticated %}
        <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
            <h2>Delivery Address</h2>
            {% if addresses %}
                {% for address in addresses %}
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 4px; margin-bottom: 10px; {% if address.is_default %}background: #f0f8ff;{% endif %}">
                        <strong>{{ address.title }}</strong>
                        {% if address.is_default %}<span style="color: green;">(Default)</span>{% endif %}
                        <br>
                        {{ address.full_name }}<br>
                        {{ address.address_line_1 }}<br>
                        {% if address.address_line_2 %}{{ address.address_line_2 }}<br>{% endif %}
                        {{ address.city }}, {{ address.state }} - {{ address.pincode }}<br>
                        Phone: {{ address.phone }}
                    </div>
                {% endfor %}
            {% else %}
                <p>No saved addresses. Please add an address to continue.</p>
            {% endif %}
        </div>
    {% else %}
        <div style="background: #fff3cd; padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #ffeaa7;">
            <h3>Login Required</h3>
            <p>Please <a href="{% url 'users:login' %}">login</a> to continue with checkout.</p>
        </div>
    {% endif %}
    
    <div style="text-align: center;">
        {% if user.is_authenticated %}
            <button onclick="alert('Checkout functionality coming soon!')" 
                    style="background: linear-gradient(135deg, #E91E63 0%, #FF6090 100%); color: white; border: none; padding: 15px 40px; border-radius: 25px; font-size: 18px; font-weight: 600; cursor: pointer;">
                Place Order - ₹{{ total }}
            </button>
        {% else %}
            <a href="{% url 'users:login' %}" 
               style="background: linear-gradient(135deg, #E91E63 0%, #FF6090 100%); color: white; text-decoration: none; padding: 15px 40px; border-radius: 25px; font-size: 18px; font-weight: 600; display: inline-block;">
                Login to Continue
            </a>
        {% endif %}
    </div>
</div>
{% endblock %}